![[Figure14.5]]

punctual light sources로 부터 in-scattering 적분은 다음과 같이 행해질 수 있다.
![[Attachments/Pasted image 20250516141438.png]]
- n: lights의 수
- p(): phase function
- v(): visibility function
- lci: ith light를 향하는 방향 벡터
- plighti: ith light의 위치
- clighti(): ith light로 부터 나오는 radiance. 거리함수에 따라 결정되며 이는 [[9.4|Section 9.4]]의 정의와 [[5.2.2|Section 5.2.2]]의 inverse square falloff function을 기반으로 한다.
visibility function v(x, plighti)는 plighti 광원으로부터 x까지 닿는 빛의 비율을 나타낸다.
![[Attachments/Pasted image 20250516142216.png]]
여기서 volShad(x, plighti) = Tr(x, plighti)이다. 실시간 렌더링에서 그림자는 두가지 occlusion으로 부터 발생한다: opaque and volumetric. opaque 물체로 부터 그림자(shadowMap)는 전통적으로 shadow map을 사용하거나 다른 테크닉을 사용한다.([[7 |Chapter 7]])
식 14.5의 volumetric shadow(volShadow(x, plighti))는 plighti 위치에 있는 빛으로 부터 샘플 포인트 x 까지 투과도를 나타내며, 범위는 \[0, 1]이다. volume으로 부터 만들어지는 occlusion은 volumetric rendering에서 중요한 요소인데, volume 요소가 self-shadow를 만들거나 다른 씬 요소에 shadow를 드리울수 있기 때문이다. [[Figure14.5]]를 참고 하자. 이러한 결과는 눈에서 볼륨을 통과하여 첫번째 표면 까지의 primary ray를 따라 ray marching을 수행하고, 그리고 이러한 샘플로부터 광원으로 향하는 각각의 secondary ray를 따라 ray marching을 수행함으로써 만들어 진다.
ray marching은 두 지점 사이를 n번 샘플링 하여 scattered light와 transmittance를 적분하는 것을 말한다. 샘플링에 대한 자세한 내용은 heightfield 렌더링에 사용된 [[6.8.1|Section 6.8.1]]을 참고. 